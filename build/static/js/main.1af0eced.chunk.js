(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{270:function(e,t,n){e.exports=n.p+"static/media/loading.c5590569.svg"},274:function(e,t,n){e.exports=n(575)},365:function(e,t,n){},444:function(e,t,n){},446:function(e,t,n){},471:function(e,t){},473:function(e,t){},508:function(e,t){},509:function(e,t){},575:function(e,t,n){"use strict";n.r(t);var a=n(15),i=n.n(a),o=(n(365),n(367),n(1)),r=n.n(o),c=n(579),s=n(578),l=n(577),u=n(29),h=n(30),m=n(41),d=n(39),g=n(42),p=n(26),f=(n(444),function(e){function t(){return Object(u.a)(this,t),Object(m.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(h.a)(t,[{key:"goTo",value:function(e){this.props.history.replace("/".concat(e))}},{key:"login",value:function(){this.props.auth.login()}},{key:"logout",value:function(){this.props.auth.logout()}},{key:"componentDidMount",value:function(){var e=this.props.auth.renewSession;"true"===localStorage.getItem("isLoggedIn")&&e()}},{key:"render",value:function(){var e=this.props.auth.isAuthenticated;return r.a.createElement("div",null,r.a.createElement(p.d,{fluid:!0},r.a.createElement(p.d.Header,null,r.a.createElement(p.d.Brand,null,r.a.createElement("a",{href:"#"},"Clause - API Sample")),r.a.createElement(p.a,{bsStyle:"primary",className:"btn-margin",onClick:this.goTo.bind(this,"home")},"Home"),!e()&&r.a.createElement(p.a,{id:"qsLoginBtn",bsStyle:"primary",className:"btn-margin",onClick:this.login.bind(this)},"Log In"),e()&&r.a.createElement(p.a,{bsStyle:"primary",className:"btn-margin",onClick:this.goTo.bind(this,"profile")},"Profile"),e()&&r.a.createElement(p.a,{bsStyle:"primary",className:"btn-margin",onClick:this.goTo.bind(this,"ping")},"Contracts"),e()&&r.a.createElement(p.a,{id:"qsLogoutBtn",bsStyle:"primary",className:"btn-margin",onClick:this.logout.bind(this)},"Log Out"))))}}]),t}(o.Component)),b=function(e){function t(){return Object(u.a)(this,t),Object(m.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(h.a)(t,[{key:"login",value:function(){this.props.auth.login()}},{key:"render",value:function(){var e=this.props.auth.isAuthenticated;return r.a.createElement("div",{className:"container"},e()&&r.a.createElement("h4",null,"You are logged in!"),!e()&&r.a.createElement("h4",null,"You are not logged in! Please"," ",r.a.createElement("a",{style:{cursor:"pointer"},onClick:this.login.bind(this)},"Log In")," ","to continue."))}}]),t}(o.Component),v=(n(446),function(e){function t(){return Object(u.a)(this,t),Object(m.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(h.a)(t,[{key:"componentWillMount",value:function(){var e=this;this.setState({profile:{}});var t=this.props.auth,n=t.userProfile,a=t.getProfile;n?this.setState({profile:n}):a(function(t,n){e.setState({profile:n})})}},{key:"render",value:function(){var e=this.state.profile;return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"profile-area"},r.a.createElement("h1",null,e.firstName," ",e.lastName),r.a.createElement(p.e,{header:"Profile"},r.a.createElement("div",null,r.a.createElement(p.b,null,r.a.createElement(p.c,{glyph:"user"})," Email"),r.a.createElement("h3",null,e.email)),r.a.createElement("pre",null,JSON.stringify(e,null,2)))))}}]),t}(o.Component)),y="https://api.clause.io/v1",k=n(92),E=n.n(k),O=function(e){function t(e){var n;return Object(u.a)(this,t),(n=Object(m.a)(this,Object(d.a)(t).call(this,e))).state={contracts:[]},n}return Object(g.a)(t,e),Object(h.a)(t,[{key:"componentWillMount",value:function(){var e=this,t=this.props.auth.getAccessToken,n={Authorization:"Bearer ".concat(t())};E.a.get("".concat(y,"/contracts/search"),{headers:n}).then(function(t){return e.setState({contracts:t.data.contracts})}).catch(function(t){return e.setState({message:t.message})})}},{key:"render",value:function(){var e=this.props.auth.isAuthenticated,t=this.state.contracts;return r.a.createElement("div",{className:"container"},r.a.createElement("h2",null,"Contracts"),!e()&&r.a.createElement("p",null,"Log in to list your contracts."),e()&&r.a.createElement("ul",null,t.map(function(e,t){return r.a.createElement("li",{key:t},r.a.createElement("p",null,r.a.createElement("a",{href:"https://hub.clause.io/contract/"+e.id},e.name)))})))}}]),t}(o.Component),j=n(270),S=n.n(j),w=function(e){function t(){return Object(u.a)(this,t),Object(m.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(g.a)(t,e),Object(h.a)(t,[{key:"render",value:function(){return r.a.createElement("div",{style:{position:"absolute",display:"flex",justifyContent:"center",height:"100vh",width:"100vw",top:0,bottom:0,left:0,right:0,backgroundColor:"white"}},r.a.createElement("img",{src:S.a,alt:"loading"}))}}]),t}(o.Component),A="login.clause.io",T="0kpMKjPOVgBD0o7iUSvDVuqB1nt4vZE8",C="http://localhost:3000/callback",I="https://api.clause.io",_=n(271),P=n.n(_)()(),N=n(115),L=n.n(N),B=n(272),x=n.n(B),D=n(273),z=n.n(D),M=new(function(){function e(){Object(u.a)(this,e),this.login=this.login.bind(this),this.logout=this.logout.bind(this),this.handleAuthentication=this.handleAuthentication.bind(this),this.isAuthenticated=this.isAuthenticated.bind(this),this.getAccessToken=this.getAccessToken.bind(this),this.getIdToken=this.getIdToken.bind(this),this.renewSession=this.renewSession.bind(this),this.getProfile=this.getProfile.bind(this)}return Object(h.a)(e,[{key:"login",value:function(){var e=function(e){return e.toString("base64").replace(/\+/g,"-").replace(/\//g,"_").replace(/=/g,"")},t=e(L.a.randomBytes(32));localStorage.setItem("verifier",t);var n=e(L.a.createHash("sha256").update(t).digest());window.location="https://".concat(A,"/authorize?audience=").concat(I,"&scope=write:all&response_type=code&client_id=").concat(T,"&redirect_uri=").concat(C,"&code_challenge=").concat(n,"&code_challenge_method=S256")}},{key:"handleAuthentication",value:function(e){var t=this,n=localStorage.getItem("verifier"),a=x.a.stringify({grant_type:"authorization_code",client_id:T,code_verifier:n,code:e,redirect_uri:C}),i={"Content-Length":a.length,"Content-Type":"application/x-www-form-urlencoded"};E.a.post("https://".concat(A,"/oauth/token"),a,{headers:i}).then(function(e){var n=e.data;return t.setSession(n)}).catch(function(e){return console.error(e)})}},{key:"getAccessToken",value:function(){return this.accessToken}},{key:"getIdToken",value:function(){return this.idToken}},{key:"setSession",value:function(e){if(e&&e.access_token){localStorage.setItem("isLoggedIn","true"),localStorage.removeItem("verifier");var t=1e3*e.expires_in+(new Date).getTime();this.accessToken=e.access_token,this.expiresAt=t,P.replace("/home")}}},{key:"renewSession",value:function(){localStorage.removeItem("isLoggedIn")}},{key:"getProfile",value:function(e){var t=this,n=this.getAccessToken(),a=z.a.decode(n).sub.substring(6),i={Authorization:"Bearer ".concat(n)};E.a.get("".concat(y,"/users/").concat(a,"/full"),{headers:i}).then(function(n){t.userProfile=n.data,e(null,t.userProfile)}).catch(function(t){return e(t,null)})}},{key:"logout",value:function(){this.accessToken=null,this.idToken=null,this.expiresAt=0,this.userProfile=null,localStorage.removeItem("isLoggedIn"),window.location="https://".concat(A,"/v2/logout")}},{key:"isAuthenticated",value:function(){var e=this.expiresAt;return(new Date).getTime()<e}}]),e}()),q=r.a.createElement(c.a,{history:P},r.a.createElement("div",null,r.a.createElement(s.a,{path:"/",render:function(e){return r.a.createElement(f,Object.assign({auth:M},e))}}),r.a.createElement(s.a,{path:"/home",render:function(e){return r.a.createElement(b,Object.assign({auth:M},e))}}),r.a.createElement(s.a,{path:"/profile",render:function(e){return M.isAuthenticated()?r.a.createElement(v,Object.assign({auth:M},e)):r.a.createElement(l.a,{to:"/home"})}}),r.a.createElement(s.a,{path:"/ping",render:function(e){return M.isAuthenticated()?r.a.createElement(O,Object.assign({auth:M},e)):r.a.createElement(l.a,{to:"/home"})}}),r.a.createElement(s.a,{path:"/callback",render:function(e){return function(e){var t=e.location;console.log(t),"?code="===t.search.substring(0,6)&&M.handleAuthentication(t.search.substring(6))}(e),r.a.createElement(w,e)}})));i.a.render(q,document.getElementById("root"))}},[[274,2,1]]]);
//# sourceMappingURL=main.1af0eced.chunk.js.map